<mxfile host="app.diagrams.net" modified="2025-12-01T00:00:00.000Z" agent="5.0" etag="logic-diagram-full" version="21.1.1" type="device">
  <diagram name="Logic Diagram Full System" id="logic-full">
    <mxGraphModel dx="2000" dy="1500" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2400" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- TITLE -->
        <mxCell id="title" value="SƠ ĐỒ LOGIC TỔNG THỂ - ỨNG DỤNG ANDROID E-COMMERCE&#xa;(Ứng dụng Bán Đồng Hồ)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="700" y="20" width="600" height="50" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- TẦNG CLIENT (ANDROID APP) -->
        <!-- ============================================ -->
        <mxCell id="client-box" value="TẦNG CLIENT (ANDROID APP)" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#f5f5f5;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="700" height="500" as="geometry"/>
        </mxCell>
        
        <!-- UI Layer -->
        <mxCell id="ui-box" value="UI Layer - Activities/Fragments" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="60" y="120" width="660" height="180" as="geometry"/>
        </mxCell>
        
        <mxCell id="splash" value="SplashActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="80" y="150" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="login" value="LoginActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="150" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="register" value="RegisterActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="280" y="150" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="main" value="MainActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="380" y="150" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="productlist" value="ProductList&#xa;Fragment" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="480" y="150" width="80" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="productdetail" value="ProductDetail&#xa;Activity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="570" y="150" width="80" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="cart" value="CartActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="660" y="150" width="80" height="40" as="geometry"/>
        </mxCell>
        
        <mxCell id="checkout" value="CheckoutActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="80" y="200" width="100" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="payment" value="PaymentActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="190" y="200" width="100" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="orderhistory" value="OrderHistory&#xa;Activity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="300" y="200" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="orderdetail" value="OrderDetail&#xa;Activity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="400" y="200" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="profile" value="ProfileActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="500" y="200" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="admin" value="AdminActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="600" y="200" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="search" value="SearchActivity" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="80" y="250" width="90" height="40" as="geometry"/>
        </mxCell>
        
        <!-- Business Logic Layer -->
        <mxCell id="logic-box" value="Business Logic Layer" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="60" y="310" width="330" height="120" as="geometry"/>
        </mxCell>
        
        <mxCell id="viewmodel" value="ViewModel" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="80" y="345" width="90" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="repository" value="Repository" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="345" width="90" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="retrofit" value="RetrofitClient" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="280" y="345" width="90" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="apiservice" value="APIService&#xa;Interface" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="80" y="390" width="90" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="okhttp" value="OkHttp&#xa;Interceptor" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="390" width="90" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="gson" value="Gson&#xa;Converter" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="280" y="390" width="90" height="35" as="geometry"/>
        </mxCell>
        
        <!-- Local Storage Layer -->
        <mxCell id="storage-box" value="Local Storage" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="410" y="310" width="310" height="120" as="geometry"/>
        </mxCell>
        
        <mxCell id="paperdb" value="PaperDB&#xa;(Cart Cache)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="430" y="345" width="80" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="sharedpref" value="SharedPref&#xa;(Session)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="520" y="345" width="80" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="room" value="Room DB&#xa;(Offline)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="610" y="345" width="80" height="60" as="geometry"/>
        </mxCell>
        
        <!-- Note Client -->
        <mxCell id="note-client" value="ANDROID CLIENT&#xa;- Kotlin/Java&#xa;- MVVM Architecture&#xa;- Retrofit + OkHttp&#xa;- LiveData/Flow&#xa;- Glide (Images)" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;strokeColor=#000000;fillColor=#FFFFFF;align=left;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="60" y="450" width="150" height="100" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- TẦNG SERVER (PHP API BACKEND) -->
        <!-- ============================================ -->
        <mxCell id="server-box" value="TẦNG SERVER (PHP API BACKEND)" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#e8e8e8;" vertex="1" parent="1">
          <mxGeometry x="780" y="80" width="700" height="500" as="geometry"/>
        </mxCell>
        
        <!-- Authentication APIs -->
        <mxCell id="auth-box" value="Authentication APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="800" y="120" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-login" value="dangnhap.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="810" y="150" width="85" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-register" value="dangki.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="900" y="150" width="85" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-resetpwd" value="quenmatkhau.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="810" y="180" width="175" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Product APIs -->
        <mxCell id="product-box" value="Product APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1020" y="120" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-categories" value="getloaisp.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1030" y="150" width="85" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-products" value="getsanpham.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1120" y="150" width="90" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-detail" value="chitiet.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1030" y="180" width="85" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-search" value="timkiem.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1120" y="180" width="90" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Cart APIs -->
        <mxCell id="cart-api-box" value="Cart APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1240" y="120" width="220" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-addcart" value="themGioHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1250" y="150" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-getcart" value="getGioHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1355" y="150" width="95" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-updatecart" value="capNhatGioHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1250" y="180" width="110" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-deletecart" value="xoaGioHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1365" y="180" width="85" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Order APIs -->
        <mxCell id="order-api-box" value="Order APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="800" y="240" width="220" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-createorder" value="taoDonHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="810" y="270" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-getorders" value="getDonHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="915" y="270" width="95" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-orderdetail" value="getChiTietDonHang.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="810" y="300" width="120" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-updatestatus" value="capNhatTrangThai.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="935" y="300" width="75" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Payment APIs -->
        <mxCell id="payment-api-box" value="Payment APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1040" y="240" width="220" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-vnpay" value="vnpay_create.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1050" y="270" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-vnpayreturn" value="vnpay_return.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1155" y="270" width="95" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-paypal" value="paypal_create.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1050" y="300" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-paypalexec" value="paypal_execute.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1155" y="300" width="95" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Voucher APIs -->
        <mxCell id="voucher-api-box" value="Voucher APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1280" y="240" width="180" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="api-vouchers" value="getAllVouchers.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1290" y="270" width="160" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-applyvoucher" value="applyVoucher.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1290" y="300" width="160" height="25" as="geometry"/>
        </mxCell>
        
        <!-- Admin APIs -->
        <mxCell id="admin-api-box" value="Admin APIs" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=25;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="800" y="360" width="340" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="api-users" value="getAllUsers.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="810" y="390" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-updatesp" value="updatesp.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="915" y="390" width="100" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="api-stock" value="capNhatTonKho.php" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1020" y="390" width="110" height="25" as="geometry"/>
        </mxCell>
        
        <!-- DB Connection -->
        <mxCell id="dbconnect" value="connect.php&#xa;(DB Connection)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#d4edda;" vertex="1" parent="1">
          <mxGeometry x="1160" y="370" width="120" height="50" as="geometry"/>
        </mxCell>
        
        <!-- Note Server -->
        <mxCell id="note-server" value="PHP BACKEND&#xa;- RESTful API&#xa;- JSON Response&#xa;- Session Management&#xa;- Input Validation" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;strokeColor=#000000;fillColor=#FFFFFF;align=left;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="1300" y="360" width="150" height="100" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- TẦNG DATABASE (MySQL) -->
        <!-- ============================================ -->
        <mxCell id="db-box" value="TẦNG DATABASE (MySQL)" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#d9d9d9;" vertex="1" parent="1">
          <mxGeometry x="40" y="620" width="700" height="280" as="geometry"/>
        </mxCell>
        
        <mxCell id="db" value="appbandienthoai" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="60" y="660" width="100" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="tbl-user" value="user" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="660" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-product" value="sanphammoi" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="290" y="660" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-category" value="loaisp" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="400" y="660" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-cart" value="cart" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="510" y="660" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-cartitems" value="cart_items" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="620" y="660" width="100" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="tbl-order" value="donhang" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="760" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-orderdetail" value="chitietdonhang" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="290" y="760" width="110" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-voucher" value="voucher" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="410" y="760" width="100" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="tbl-voucherusage" value="voucher_usage" style="shape=table;startSize=25;container=1;collapsible=0;childLayout=tableLayout;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="520" y="760" width="110" height="80" as="geometry"/>
        </mxCell>
        
        <!-- Note DB -->
        <mxCell id="note-db" value="MySQL DATABASE&#xa;- InnoDB Engine&#xa;- Foreign Keys&#xa;- Triggers (tonkho)&#xa;- Transactions" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;strokeColor=#000000;fillColor=#FFFFFF;align=left;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="60" y="760" width="110" height="100" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- DỊCH VỤ BÊN NGOÀI -->
        <!-- ============================================ -->
        <mxCell id="external-box" value="DỊCH VỤ BÊN NGOÀI (EXTERNAL SERVICES)" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#fff3cd;" vertex="1" parent="1">
          <mxGeometry x="780" y="620" width="700" height="280" as="geometry"/>
        </mxCell>
        
        <mxCell id="google-auth" value="Google/Firebase&#xa;Auth" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="820" y="670" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="vnpay-gateway" value="VNPay&#xa;Gateway" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="970" y="670" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="paypal-gateway" value="PayPal&#xa;Gateway" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1120" y="670" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="email-service" value="Email Service&#xa;(OTP)" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1270" y="670" width="120" height="60" as="geometry"/>
        </mxCell>
        
        <!-- Note External -->
        <mxCell id="note-external" value="EXTERNAL SERVICES&#xa;- Firebase Auth&#xa;- VNPay Sandbox/Production&#xa;- PayPal REST API&#xa;- SMTP Email" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;strokeColor=#000000;fillColor=#FFFFFF;align=left;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="820" y="760" width="180" height="100" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- LUỒNG LOGIC CHÍNH -->
        <!-- ============================================ -->
        
        <!-- 1-3: Khởi động -->
        <mxCell id="flow1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="sharedpref">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="170" y="170" as="sourcePoint"/>
            <mxPoint x="430" y="375" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="170" y="375"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow1-label" value="1. Check Session" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="250" y="360" width="80" height="20" as="geometry"/>
        </mxCell>
        
        <!-- 4-18: Login flow -->
        <mxCell id="flow2" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="225" y="190" as="sourcePoint"/>
            <mxPoint x="225" y="345" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow2-label" value="4. Login" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="230" y="260" width="50" height="20" as="geometry"/>
        </mxCell>
        
        <!-- Client to Server -->
        <mxCell id="flow3" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="740" y="365" as="sourcePoint"/>
            <mxPoint x="800" y="170" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="770" y="365"/>
              <mxPoint x="770" y="170"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow3-label" value="HTTP&#xa;Request" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="745" y="250" width="50" height="30" as="geometry"/>
        </mxCell>
        
        <!-- Server to Database -->
        <mxCell id="flow4" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="420" as="sourcePoint"/>
            <mxPoint x="160" y="660" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="1220" y="540"/>
              <mxPoint x="160" y="540"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow4-label" value="SQL Query" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="680" y="520" width="60" height="20" as="geometry"/>
        </mxCell>
        
        <!-- Server to External -->
        <mxCell id="flow5" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1100" y="325" as="sourcePoint"/>
            <mxPoint x="1030" y="670" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="1100" y="500"/>
              <mxPoint x="1030" y="500"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow5-label" value="Payment&#xa;API" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1035" y="480" width="50" height="30" as="geometry"/>
        </mxCell>
        
        <!-- Client to External (Google Auth) -->
        <mxCell id="flow6" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="270" y="170" as="sourcePoint"/>
            <mxPoint x="880" y="670" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="270" y="130"/>
              <mxPoint x="760" y="130"/>
              <mxPoint x="760" y="600"/>
              <mxPoint x="880" y="600"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="flow6-label" value="Google&#xa;Sign-In" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="760" y="590" width="50" height="30" as="geometry"/>
        </mxCell>
        
        <!-- ============================================ -->
        <!-- LEGEND -->
        <!-- ============================================ -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="1030" y="760" width="420" height="130" as="geometry"/>
        </mxCell>
        <mxCell id="legend-title" value="CHÚ GIẢI LUỒNG LOGIC" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1170" y="765" width="150" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="legend-1" value="1-3: Khởi động &amp; Kiểm tra session" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="790" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-2" value="4-18: Đăng nhập / Đăng ký" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="805" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-3" value="19-34: Xem danh sách &amp; chi tiết sản phẩm" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="820" width="200" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-4" value="35-46: Thêm vào giỏ hàng" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="835" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-5" value="47-63: Quản lý giỏ hàng" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="850" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-6" value="64-74: Checkout &amp; Áp dụng voucher" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1040" y="865" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-7" value="75-97: Thanh toán (COD/VNPay/PayPal)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1250" y="790" width="190" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-8" value="98-104: Kết quả &amp; Điều hướng" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1250" y="805" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-9" value="105-116: Xem lịch sử đơn hàng" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1250" y="820" width="180" height="15" as="geometry"/>
        </mxCell>
        <mxCell id="legend-10" value="117-123: Quản trị Admin" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1250" y="835" width="180" height="15" as="geometry"/>
        </mxCell>
        
        <!-- Footer -->
        <mxCell id="footer" value="Sơ đồ Logic Tổng Thể - Ứng dụng Bán Đồng Hồ E-Commerce | Cập nhật: 01/12/2025" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="600" y="910" width="400" height="20" as="geometry"/>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>